version: "3.2"

services:

  hydra:
    image: "oryd/hydra:v1.0.0"
    networks:
      - traefik
    labels:
      - "traefik.enable=true"
      - "traefik.backend=hydra-api"
      - "traefik.frontend.rule=Host:hydra-api.docker.localhost"
      - "traefik.port=4444"
      - "traefik.docker.network=traefik"
    command:
      serve all --dangerous-force-http
    environment:
      SECRETS_SYSTEM: "Jkb5KzustUdt7cZ5rYfLsf8m7"
      DSN: "postgres://infra:infra@postgres/hydra?sslmode=disable"
      URLS_SELF_ISSUER: "https://hydra-api.docker.localhost/"
      ISSUER: "http://hydra:4444/"

networks:
  traefik:
    external:
      name: traefik
